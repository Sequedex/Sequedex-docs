.. _s.install:

Installation instructions
*************************

===================
System requirements
===================

* A 64-bit operating system with at least 4 GB of RAM is recommended.  For Mac, we recommend Snow Leopard or later (Mac OSX 10.6), for Linux, a 2.6 kernel or later, and for Windows, Windows 7 or 8.

* Sequedex requires version 1.7 or 1.8 of the 64-bit Java SE runtime environment installed.  It is possible also to use Sequedex with several 64-bit versions of Java, such as those found at http://www.java.com/en/download/manual.jsp or that may already be installed on your computer.

* Sequedex requires Python, and we suggest installation of Anaconda, which includes a wide variety of scientific and bioinformatic packages together with Python.

* If you are installing Sequedex remotely on a server, you will need to have at least a minimal X-windows environment installed, since Sequedex requires a GUI for the licensing step.  Note that ssh -Y enables forwarding of X-windows on most systems.

* With the included data module, Life2550-4GB, Sequedex uses a maximum Java heap size of less than 4 GB.  Larger 'Life2550' data modules, require more RAM, and provide a higher sensitivity, due to more extensive signature lists.  Desktop computers can be purchases for under $1000 with 32 GB of RAM, and servers with 64 GB or more of RAM are widely available.  Given the expense of acquiring sequence data, it seems likely that an investment of a 32 GB desktop computer for analysis would be warrented.  We have found USB 3.0 drives for reference data (currently $120 per 3 TB drive) is also an effective investment.

* Sequedex is designed to run multiple Java threads, with each thread processing one input file.  Depending on whether the input file is compressed (.gz files are supported), whether classified reads are written to disk, and the I/O speed of your disk (USB 3.0 or Thunderbolt drives work well), we have observed the total performance of Sequedex to continue to improve, even with 48 threads (on a machine with 48 cores).  Certainly, all available threads on dual- and quad-core processors would be effectively utilized.
  


=================================
Downloading and unpacking for Mac
=================================

For now, installation is by command line on all platforms::

 curl -O http://sequedex.lanl.gov/downloads/sequedex-current.tgz
 tar -xzf sequedex-current.tgz
 cd sequedex

If your computer has more than 4 GB of memory and if you have a proper python installed as under "System Requirements", then you should do::

 bin/sequedex-install

You should then execute the::

 bin/sequescan

command and proceed with obtaining a demo license by using Utilities..Request License and following the instructions there. More details are available in the online documentation.

===================================
Downloading and unpacking for Linux
===================================

For now, installation is by command line on all platforms::

 curl -O http://sequedex.lanl.gov/downloads/sequedex-current.tgz
 tar -xzf sequedex-current.tgz
 cd sequedex

If your computer has more than 4 GB of memory and if you have a proper python installed as under "System Requirements", then you should type::

 bin/sequedex-install

You should then execute::

 bin/sequescan

command and proceed with obtaining a demo license by using Utilities..Request License and following the instructions there. More details are available in the online documentation.

Downloading and unpacking for Windows 7 with Cygwin installed
=============================================================

We are currently in the final stages of packaging Sequedex for Windows.

================================================================
Downloading and unpacking for Windows 7 without Cygwin installed
================================================================

We are currently in the final stages of packaging Sequedex for Windows.

=========================
Testing your installation
=========================

To test that Sequedex is installed properly, open the Sequedex GUI,
click on the file chooser icon at the right edge of the "Input" text
field.  Mac users should find the testData directory described in the
installation instructions above.  Linux users will find the same
testData directory at the top level of the Sequedex distribution
directory (i.e. in the same place as the bin directory).  Under the
testData directory, users will find another directory called
"synthetic" and should then select one of the files under this
directory.  Click "Run Sequescan" button...

Note: If you have not yet installed a license file, the following
message will appear in the Progress window of the GUI::

 You are currently unlicensed.   Limited analysis will be allowed for testing purposes.

Instructions for installing a license are provided below.

========================================
Running Sequedex on an example data file
========================================

To analyze a file of sequence data with Sequedex:

*  Click on file chooser icon at the right edge of the "Input" line (Mac) or type 'sequescan' at the command prompt after correctly updating your PATH variable (Mac or Linux).  You should get an interface like the one shown below.
*  Select the testData directory you installed earlier
*  Select one of the files under one of the sub-directories of "testData"
*  Click "Run Sequescan"

.. figure:: images/sequescan_GUI.png
   :width: 60%
    
   The graphical user interface for sequescan.

After the "Run Sequescan" button is pressed, a few lines should appear
in the "Progress" portion of the interface immediately. Sequedex will
spend about one minute reading the bact403, and about 15 minutes
reading the tol-all signature list into memory.  Once this is
complete, processing of the data files will occur at a rate of a few
billion base pairs per second.  We will examine the run-time options
and output files in the next chapter.

====================================
Obtaining a node-locked license file
====================================

Without a license file, Sequedex will only analyze a few tens of
thousands of reads at a time, and batch file processing is disabled.
This will enable the user to analyze bacterial genomes and portions of
metagenomics data sets to verify that Sequedex is performing
correctly.  You may obtain a free 60-day node-locked demo license by
submtting a license information file by e-mail.  The terms of the demo
license are available :download:`here <dl/license.txt>`.

To request a license, you must first create a license information
file: start the Sequedex GUI and click on 'Utilities' at the top of
the GUI, then on 'Request license'.  Follow the instructions to
generate a license information file.  E-mail this license information
file to to sequedex-demo-license@lanl.gov. A demo license will be
returned to you immediately if your e-mail address has not requested a
demo before.  This file can be installed by choosing 'Install License'
under the same 'Utilities' tab at the top of the sequescan GUI.  If
the license is correctly installed in the .sequedex subdirectory of
your home directory, you will notice that mutiple threads and
multi-file processing is enabled.  If 'verbose' mode is selected, you
will be notified that 'License level is 1' will be displayed as
Sequescan starts its run.  Since the license file is stored outside
the Sequedex root directory, this file will not be overwritten when
Sequedex is upgraded with a new distribution.

==================================================================
Installing new data modules and upgrading Sequedex - User-installs
==================================================================

New data modules can be installed into a Sequedex distribution by
copying them into the sequedex/data/ directory.

A new Sequedex distribution can be installed directly with the install
script if available (and if the existing version of Sequedex was set
up in the default location) or by unpacking on top of the existing
Sequedex distribution.  Since the license file is located outside of
the Sequedex distribution (in the .sequedex directory of the user's
home directory) for User-install, it will be unaffected by a
re-install of Sequedex.

====================================================================
Installing new data modules and upgrading Sequedex - System-installs
====================================================================

The license for Sequedex is node-locked, and not restricted to a
single user.  Consequently, the license file can either be located
within the Sequedex distribution or copied into each
user's home directory, into the ~/.sqdx directory.  Note for Cygwin
users, that the home directory is the Windows home directory
(Typically c:\Users\home\username\) and not the Cygwin home directory.
For system installs, all users must have read and execute
permissions to the Sequedex distribution, and new data modules can
only be installed by someone with write permissions to the
sequedex/data/ directory.
